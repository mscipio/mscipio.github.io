<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.54.0" />
  <meta name="author" content="Michele Scipioni">
  <meta name="description" content="Ph.D. student in Biomedical Engineering">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  

  <link rel="alternate" href="https://mscipio.github.io/index.xml" type="application/rss+xml" title="Michele Scipioni">
  <link rel="feed" href="https://mscipio.github.io/index.xml" type="application/rss+xml" title="Michele Scipioni">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://mscipio.github.io/post/matlab_toolbox_nbin_mu/">

  <link rel="stylesheet" href="https://mscipio.github.io/css/override.css">


  <title>Exending MATLAB&#39;s tools for Negative Binomial distributions: nbin*_mu.m | Michele Scipioni</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Michele Scipioni</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  <h1 itemprop="name">Exending MATLAB&#39;s tools for Negative Binomial distributions: nbin*_mu.m</h1>
  <img src="/img/headers/white.png" class="article-banner" itemprop="image">
  
</div>  



  <div class="article-container">
    
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-11-16 10:00:00 &#43;0000 UTC" itemprop="datePublished">
      Thu, Nov 16, 2017
    </time>
  </span>

  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/matlab">MATLAB</a
    >, 
    
    <a href="/tags/software">software</a
    >, 
    
    <a href="/tags/toolbox">toolbox</a
    >, 
    
    <a href="/tags/statistics">statistics</a
    >, 
    
    <a href="/tags/distribution">distribution</a
    >, 
    
    <a href="/tags/probability">probability</a
    >, 
    
    <a href="/tags/negative-binomial">Negative Binomial</a
    >, 
    
    <a href="/tags/nb">NB</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fmscipio.github.io%2fpost%2fmatlab_toolbox_nbin_mu%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Exending%20MATLAB%27s%20tools%20for%20Negative%20Binomial%20distributions%3a%20nbin%2a_mu.m&amp;url=https%3a%2f%2fmscipio.github.io%2fpost%2fmatlab_toolbox_nbin_mu%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fmscipio.github.io%2fpost%2fmatlab_toolbox_nbin_mu%2f&amp;title=Exending%20MATLAB%27s%20tools%20for%20Negative%20Binomial%20distributions%3a%20nbin%2a_mu.m"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fmscipio.github.io%2fpost%2fmatlab_toolbox_nbin_mu%2f&amp;title=Exending%20MATLAB%27s%20tools%20for%20Negative%20Binomial%20distributions%3a%20nbin%2a_mu.m"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Exending%20MATLAB%27s%20tools%20for%20Negative%20Binomial%20distributions%3a%20nbin%2a_mu.m&amp;body=https%3a%2f%2fmscipio.github.io%2fpost%2fmatlab_toolbox_nbin_mu%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      

<hr />

<p>Introducing a new set of functions able to deal with the common µ-k parametrization of the Negative Binomial distribution for count data.</p>

<p><a href="https://github.com/mscipio/MATLABtools___nbin_mu" style="color:red"><b>[GitHub SOURCE CODE]</b></a></p>

<hr />

<h2 id="negative-binomial-distribution">Negative Binomial Distribution</h2>

<p>Negative binomial regression is for modeling count variables, usually for over-dispersed count outcome variables.</p>

<h4 id="negative-binomial-regression">Negative binomial regression</h4>

<p>Negative binomial regression can be used for over-dispersed count data, that is when the conditional variance exceeds the conditional mean. It can be considered as a generalization of Poisson regression since it has the same mean structure as Poisson regression and it has an extra parameter to model the over-dispersion. If the conditional distribution of the outcome variable is over-dispersed, the confidence intervals for the Negative binomial regression are likely to be narrower as compared to those from a Poisson regression model.</p>

<h4 id="poisson-regression">Poisson regression</h4>

<p>Poisson regression is often used for modeling count data. Poisson regression has a number of extensions useful for count models.</p>

<h4 id="zero-inflated-regression-model">Zero-inflated regression model</h4>

<p>Zero-inflated models attempt to account for excess zeros. In other words, two kinds of zeros are thought to exist in the data, “true zeros” and “excess zeros”. Zero-inflated models estimate two equations simultaneously, one for the count model and one for the excess zeros.</p>

<h4 id="ols-regression">OLS regression</h4>

<p>Count outcome variables are sometimes log-transformed and analyzed using OLS regression. Many issues arise with this approach, including loss of data due to undefined values generated by taking the log of zero (which is undefined), as well as the lack of capacity to model the dispersion.</p>

<p>Matlab provides some functions to experiments with Negative Binomial Distribution.</p>

<p>Problem is that, for this parcticular family of distribution, you can find different kind of parametrization. According to the problem you are trying to solve or reproduce, one parametrization can me better than another.</p>

<p>For a general idea of what I mean by <strong><em>different parametrization</em></strong>, you can have a look at the Wikipedia page related to NB distribution, at <a href="https://en.m.wikipedia.org/wiki/Negative_binomial_distribution#Alternative_formulations" target="_blank">https://en.m.wikipedia.org/wiki/Negative_binomial_distribution#Alternative_formulations</a>.</p>

<h2 id="matlab-choice-of-parametrization-r-p">Matlab choice of parametrization: r-p</h2>

<p>In its simplest form (when r is an integer), the negative binomial distribution models the number of failures x before a specified number of successes is reached in a series of independent, identical trials. Its parameters are the probability of success in a single trial, p, and the number of successes, r. A special case of the negative binomial distribution, when r = 1, is the geometric distribution, which models the number of failures before the first success.</p>

<p>More generally, r can take on non-integer values. This form of the negative binomial distribution has no interpretation in terms of repeated trials, but, like the Poisson distribution, it is useful in modeling count data. The negative binomial distribution is more general than the Poisson distribution because it has a variance that is greater than its mean, making it suitable for count data that do not meet the assumptions of the Poisson distribution. In the limit, as r increases to infinity, the negative binomial distribution approaches the Poisson distribution.</p>

<p>To deal with this version of negative binomial distribution, the <strong>Statistics and Machine Learning Toolbox</strong> provide the following set of functions:</p>

<ul>
<li><em>nbinrnd.m</em></li>
<li><em>nbinlike.m</em></li>
<li><em>nbinfit.m</em></li>
<li><em>nbinpdf.m</em></li>
</ul>

<h2 id="ecological-parameterization-of-the-negative-binomial-µ-k">&ldquo;Ecological&rdquo; parameterization of the negative binomial: µ-k</h2>

<p>The “ecological” parameterization of the negative binomial replaces the parameters <strong>p</strong> (probability of success per trial) and <strong>n</strong> (number of successes before you stop counting failures) with <strong><em>µ = n(1−p)/p</em></strong>, the mean number of failures expected (or of counts in a sample), and <strong>k</strong>, which is typically called an <strong>overdispersion</strong> parameter.</p>

<p>Confusingly, <strong>k</strong> is sometimes called <em>size</em>, because it is mathematically equivalent to <strong>n</strong> in the failure-process parameterization.</p>

<p>The overdispersion parameter measures the amount of clustering, or aggregation, or heterogeneity, in the data: a smaller <strong>k</strong> means more heterogeneity. The variance of the negative binomial distribution is <strong><em>µ+µ^2/k</em></strong>, and so as <strong>k</strong> becomes large the variance approaches the mean and the distribution approaches the Poisson distribution. For <em>k &gt; 10</em>, the negative binomial is hard to tell from a Poisson distribution, but <strong>k</strong> is often less than 1.</p>

<p>Specifically, you can get a negative binomial distribution as the result of a Poisson sampling process where the rate **λ **itself varies. If the distribution of <strong>λ</strong> is a gamma distribution with shape parameter <strong>k</strong> and mean <strong>µ</strong>, and <strong>x</strong> is Poisson-distributed with mean <strong>λ</strong>, then the distribution of <strong>x</strong> be a negative binomial distribution with mean <strong>µ</strong> and overdispersion parameter <strong>k</strong> (May, 1978; Hilborn and Mangel, 1997). In this case, the negative binomial reflects unmeasured (“random”) variability in the population.</p>

<p>While available in R, this kind of parametrization is not provided by Matlab most standard libraries, so this repo is about adding them so that you can have a choice of the best version of NB distribution you want to use.</p>

<p><strong>In detail, the new versions of the Matlab files you can find here are the following</strong>:</p>

<ul>
<li><em>nbinrnd_mu.m</em></li>
<li><em>nbinlike_mu.m</em></li>
<li><em>nbinfit_mu.m</em></li>
<li><em>nbinpdf_mu.m</em></li>
</ul>

    </div>
  </div>

</article>

<div class="article-container"></div>

<script src="https://utteranc.es/client.js"
  repo="mscipio/mscipio.github.io"
  issue-term="pathname"
  label="Comment"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>

</div>

<div class="container">
    <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://mscipio.github.io/post/update_kmtool_repo_14november17/"><span
      aria-hidden="true">&larr;</span> Changelog for KMtoolbox repository - November 14, 2017</a></li>
    

    
    <li class="next"><a href="https://mscipio.github.io/post/matlab-from-python/">Calling Matlab (custom) functions from Python <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Michele Scipioni &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/python.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/matlab.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

